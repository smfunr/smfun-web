<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sm.fun - Admin Control Panel</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #000; 
            color: #00ff00; 
            font-family: 'Courier New', monospace;
            overflow-x: hidden;
        }
        .header {
            background: #111;
            border-bottom: 2px solid #ff0000;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #ff0000;
        }
        .nav {
            display: flex;
            gap: 20px;
        }
        .nav-item {
            color: #00ff00;
            text-decoration: none;
            padding: 8px 16px;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        .nav-item:hover {
            background: #333;
            border-color: #00ff00;
        }
        .nav-item.active {
            background: #222;
            border-color: #ff0000;
            color: #ff0000;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }
        .dashboard-card {
            background: #222;
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 25px;
            text-align: center;
        }
        .dashboard-card.admin {
            border-color: #ff0000;
            background: linear-gradient(135deg, #222, #330000);
        }
        .card-value {
            font-size: 36px;
            font-weight: bold;
            color: #ffff00;
            margin: 10px 0;
        }
        .card-label {
            color: #888;
            font-size: 14px;
        }
        .section {
            background: #111;
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .section.admin {
            border-color: #ff0000;
        }
        .section-title {
            color: #00ffff;
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-title.admin {
            color: #ff0000;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .data-table th {
            background: #222;
            color: #00ffff;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #00ff00;
        }
        .data-table.admin th {
            color: #ff0000;
            border-bottom-color: #ff0000;
        }
        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #333;
        }
        .data-table tr:hover {
            background: #222;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        .btn {
            background: #222;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }
        .btn:hover {
            background: #333;
        }
        .btn.admin {
            border-color: #ff0000;
            color: #ff0000;
        }
        .btn.primary {
            background: linear-gradient(90deg, #00ff00, #00ffff);
            color: #000;
        }
        .btn.danger {
            background: #330000;
            border-color: #ff0000;
            color: #ff0000;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #ffff00;
        }
        .error {
            background: #330000;
            border: 1px solid #ff0000;
            color: #ff0000;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .wallet-info {
            background: #222;
            border: 1px solid #ff0000;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .wallet-address {
            font-family: monospace;
            color: #ffff00;
            margin-bottom: 10px;
        }
        .wallet-balance {
            color: #00ff00;
            font-size: 18px;
        }
        .admin-only {
            border-left: 4px solid #ff0000;
            padding-left: 15px;
            margin: 20px 0;
        }
        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">‚öôÔ∏è sm.fun Admin Control Panel</div>
        <div class="nav">
            <a href="index.html" class="nav-item">üè† Home</a>
            <a href="control-panel.html" class="nav-item active">‚öôÔ∏è Admin</a>
        </div>
    </div>
    
    <div class="container">
        <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
        <div id="loading" class="loading">
            <div style="font-size: 24px; margin-bottom: 20px;">üîÑ Loading admin dashboard...</div>
            <div>Connecting to sm.fun API...</div>
        </div>
        
        <!-- ÈîôËØØÁä∂ÊÄÅ -->
        <div id="error" class="error" style="display: none;">
            <div style="font-size: 18px; margin-bottom: 10px;">‚ùå Admin Access Required</div>
            <div id="error-message"></div>
            <button class="btn" onclick="location.reload()" style="margin-top: 15px;">Retry</button>
        </div>
        
        <!-- Èí±ÂåÖËøûÊé• -->
        <div id="connect-wallet" style="text-align: center; padding: 40px;">
            <div style="color: #ffff00; font-size: 24px; margin-bottom: 20px;">üîê Admin Wallet Required</div>
            <div style="color: #00ff00; margin-bottom: 30px; max-width: 600px; margin-left: auto; margin-right: auto;">
                This is the admin control panel. Only authorized admin wallets can access this area.
            </div>
            <button class="btn primary" onclick="connectWallet()" style="padding: 15px 30px; font-size: 16px;">Connect Admin Wallet</button>
        </div>
        
        <!-- ÁÆ°ÁêÜÂëòÂÜÖÂÆπÔºàÂä®ÊÄÅÂä†ËΩΩÔºâ -->
        <div id="admin-content" style="display: none;">
            <!-- Èí±ÂåÖ‰ø°ÊÅØ -->
            <div class="wallet-info">
                <div class="wallet-address" id="admin-wallet">0x0000...0000</div>
                <div class="wallet-balance">Balance: <span id="admin-balance">0</span> ETH</div>
                <div style="color: #ff0000; font-size: 12px; margin-top: 10px;">‚ö†Ô∏è Admin privileges active</div>
            </div>
            
            <!-- ‰ª™Ë°®ÊùøÁªüËÆ° -->
            <div class="dashboard-grid">
                <div class="dashboard-card admin">
                    <div class="card-label">Total Users</div>
                    <div class="card-value" id="total-users">0</div>
                    <div style="color: #888; font-size: 12px;">Active today: <span id="active-today">0</span></div>
                </div>
                <div class="dashboard-card">
                    <div class="card-label">Total ICO ETH</div>
                    <div class="card-value" id="total-ico-eth">0</div>
                    <div style="color: #888; font-size: 12px;">Progress: <span id="ico-progress">0%</span></div>
                </div>
                <div class="dashboard-card">
                    <div class="card-label">Trading Volume</div>
                    <div class="card-value" id="trading-volume">$0</div>
                    <div style="color: #888; font-size: 12px;">Total fees: <span id="total-fees">$0</span></div>
                </div>
                <div class="dashboard-card admin">
                    <div class="card-label">Platform Revenue</div>
                    <div class="card-value" id="platform-revenue">0 ETH</div>
                    <div style="color: #888; font-size: 12px;">Last 30 days</div>
                </div>
            </div>
            
            <!-- ÊúÄËøëÊ¥ªÂä® -->
            <div class="section admin">
                <div class="section-title admin">üìä Recent Activity</div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                    <div>
                        <div style="color: #00ffff; margin-bottom: 10px;">üë• New Users</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Wallet</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="new-users-body">
                                <!-- Êñ∞Áî®Êà∑Êï∞ÊçÆ -->
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <div style="color: #00ffff; margin-bottom: 10px;">üöÄ Recent ICO</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Wallet</th>
                                    <th>Parts</th>
                                    <th>ETH</th>
                                </tr>
                            </thead>
                            <tbody id="recent-ico-body">
                                <!-- ÊúÄËøëICOÊï∞ÊçÆ -->
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <div style="color: #00ffff; margin-bottom: 10px;">ü§ñ Recent Trades</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Bot</th>
                                    <th>Pair</th>
                                    <th>ROI</th>
                                </tr>
                            </thead>
                            <tbody id="recent-trades-body">
                                <!-- ÊúÄËøë‰∫§ÊòìÊï∞ÊçÆ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Áî®Êà∑ÁÆ°ÁêÜ -->
            <div class="section">
                <div class="section-title">üë• User Management</div>
                <div class="action-buttons" style="margin-bottom: 20px;">
                    <button class="btn primary" onclick="exportUsers()">Export Users CSV</button>
                    <button class="btn" onclick="refreshUsers()">Refresh</button>
                    <input type="text" id="user-search" class="btn" placeholder="Search wallet/username..." style="background: #000; color: #00ff00; flex-grow: 1;">
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Wallet</th>
                            <th>Username</th>
                            <th>Level</th>
                            <th>Parts</th>
                            <th>Investment</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="users-body">
                        <!-- Áî®Êà∑Êï∞ÊçÆ -->
                    </tbody>
                </table>
            </div>
            
            <!-- ICOÁÆ°ÁêÜ -->
            <div class="section">
                <div class="section-title">üöÄ ICO Management</div>
                <div class="action-buttons" style="margin-bottom: 20px;">
                    <button class="btn primary" onclick="addICOShares()">Add Parts Manually</button>
                    <button class="btn" onclick="exportICOData()">Export ICO Data</button>
                    <button class="btn danger" onclick="resetICO()">Reset ICO (Danger)</button>
                </div>
                <div style="background: #222; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="color: #00ffff; margin-bottom: 10px;">ICO Settings</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <div>
                            <div style="color: #888; font-size: 12px;">Price per part</div>
                            <div style="color: #ffff00; font-size: 18px;">0.1 ETH</div>
                        </div>
                        <div>
                            <div style="color: #888; font-size: 12px;">Total parts</div>
                            <div style="color: #ffff00; font-size: 18px;">10,000</div>
                        </div>
                        <div>
                            <div style="color: #888; font-size: 12px;">Fee sharing</div>
                            <div style="color: #ffff00; font-size: 18px;">35%</div>
                        </div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Wallet</th>
                            <th>Parts</th>
                            <th>ETH</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ico-transactions-body">
                        <!-- ICO‰∫§ÊòìÊï∞ÊçÆ -->
                    </tbody>
                </table>
            </div>
            
            <!-- Á≥ªÁªüÈÖçÁΩÆ -->
            <div class="section admin">
                <div class="section-title admin">‚öôÔ∏è System Configuration</div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
                    <div>
                        <div style="color: #ff0000; margin-bottom: 15px;">üõ°Ô∏è Security Settings</div>
                        <div style="background: #222; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
                            <div style="color: #00ff00;">Admin Wallet Whitelist</div>
                            <div style="color: #888; font-size: 12px; margin-top: 5px;" id="admin-whitelist">0x742d35Cc6634C0532925a3b844Bc9e90F1b6c168</div>
                        </div>
                        <button class="btn admin" onclick="addAdminWallet()">Add Admin Wallet</button>
                        <button class="btn danger" onclick="removeAdminWallet()">Remove Current</button>
                    </div>
                    <div>
                        <div style="color: #ff0000; margin-bottom: 15px;">üí∞ Fee Settings</div>
                        <div style="background: #222; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
                            <div style="color: #00ff00;">Trading Fee</div>
                            <div style="color: #888; font-size: 12px; margin-top: 5px;">0.1% per trade</div>
                        </div>
                        <div style="background: #222; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
                            <div style="color: #00ff00;">Withdrawal Fee</div>
                            <div style="color: #888; font-size: 12px; margin-top: 5px;">1% (min 0.001 ETH)</div>
                        </div>
                        <button class="btn admin" onclick="updateFees()">Update Fees</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../api-client.js"></script>
    <script>
        // ÁÆ°ÁêÜÂëòÈí±ÂåÖÁôΩÂêçÂçï
        const ADMIN_WALLETS = [
            '0x742d35Cc6634C0532925a3b844Bc9e90F1b6c168'.toLowerCase()
        ];
        
        let adminWallet = '';
        let adminData = {};
        
        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', async () => {
            await checkAdminAccess();
        });
        
        // Ê£ÄÊü•ÁÆ°ÁêÜÂëòËÆøÈóÆÊùÉÈôê
        async function checkAdminAccess() {
            const savedAccount = localStorage.getItem('smfun_wallet_account');
            if (!savedAccount) {
                // Ê≤°ÊúâËøûÊé•Èí±ÂåÖ
                return;
            }
            
            // Ê£ÄÊü•ÊòØÂê¶ÊòØÁÆ°ÁêÜÂëòÈí±ÂåÖ
            if (ADMIN_WALLETS.includes(savedAccount.toLowerCase())) {
                adminWallet = savedAccount;
                await loadAdminDashboard();
            } else {
                showError('                showError('Access denied. This wallet is not authorized for admin access.');
            }
        }
        
        // Âä†ËΩΩÁÆ°ÁêÜÂëò‰ª™Ë°®Êùø
        async function loadAdminDashboard() {
            try {
                // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                document.getElementById('loading').style.display = 'block';
                document.getElementById('error').style.display = 'none';
                document.getElementById('connect-wallet').style.display = 'none';
                document.getElementById('admin-content').style.display = 'none';
                
                // ‰ªéAPIÂä†ËΩΩÁÆ°ÁêÜÂëòÊï∞ÊçÆ
                const api = window.smFunAPI;
                const result = await api.getAdminDashboard();
                
                if (result.success) {
                    adminData = result.dashboard;
                    
                    // Êõ¥Êñ∞UI
                    updateAdminUI();
                    
                    // ÊòæÁ§∫ÁÆ°ÁêÜÂëòÂÜÖÂÆπ
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('admin-content').style.display = 'block';
                    
                    // Ëé∑ÂèñÈí±ÂåÖ‰ΩôÈ¢ù
                    await getAdminWalletBalance();
                    
                } else {
                    showError('Failed to load admin dashboard');
                }
                
            } catch (error) {
                console.error('Error loading admin dashboard:', error);
                showError('Failed to load admin dashboard: ' + error.message);
            }
        }
        
        // Êõ¥Êñ∞ÁÆ°ÁêÜÂëòUI
        function updateAdminUI() {
            // Èí±ÂåÖ‰ø°ÊÅØ
            const shortAddress = `${adminWallet.substring(0, 6)}...${adminWallet.substring(38)}`;
            document.getElementById('admin-wallet').textContent = shortAddress;
            document.getElementById('admin-wallet').title = adminWallet;
            
            // ‰ª™Ë°®ÊùøÁªüËÆ°
            document.getElementById('total-users').textContent = adminData.total_users || 0;
            document.getElementById('active-today').textContent = adminData.active_today || 0;
            document.getElementById('total-ico-eth').textContent = (adminData.total_ico_eth || 0).toFixed(2);
            document.getElementById('ico-progress').textContent = ((adminData.total_ico_eth || 0) / 1000 * 100).toFixed(1) + '%';
            document.getElementById('trading-volume').textContent = '$' + (adminData.total_trading_volume || 0).toLocaleString();
            document.getElementById('total-fees').textContent = '$' + (adminData.total_fees || 0).toLocaleString();
            document.getElementById('platform-revenue').textContent = (adminData.total_fees ? adminData.total_fees * 0.35 : 0).toFixed(2) + ' ETH';
            
            // Êõ¥Êñ∞ÊúÄËøëÊ¥ªÂä®Ë°®Ê†º
            updateRecentActivity();
            
            // Êõ¥Êñ∞Áî®Êà∑Ë°®Ê†ºÔºàÊ®°ÊãüÊï∞ÊçÆÔºâ
            updateUsersTable();
            
            // Êõ¥Êñ∞ICO‰∫§ÊòìË°®Ê†ºÔºàÊ®°ÊãüÊï∞ÊçÆÔºâ
            updateICOTransactionsTable();
        }
        
        // Ëé∑ÂèñÁÆ°ÁêÜÂëòÈí±ÂåÖ‰ΩôÈ¢ù
        async function getAdminWalletBalance() {
            if (typeof window.ethereum === 'undefined') {
                document.getElementById('admin-balance').textContent = '0';
                return;
            }
            
            try {
                const balance = await window.ethereum.request({
                    method: 'eth_getBalance',
                    params: [adminWallet, 'latest']
                });
                
                const ethBalance = parseInt(balance) / 1e18;
                document.getElementById('admin-balance').textContent = ethBalance.toFixed(4);
            } catch (error) {
                console.error('Error getting admin wallet balance:', error);
                document.getElementById('admin-balance').textContent = '0';
            }
        }
        
        // Êõ¥Êñ∞ÊúÄËøëÊ¥ªÂä®
        function updateRecentActivity() {
            // Êñ∞Áî®Êà∑
            const newUsersBody = document.getElementById('new-users-body');
            newUsersBody.innerHTML = '';
            
            const sampleUsers = [
                { wallet: '0x8f3a4c2d1e5b6a7c9d0f1e2a3b4c5d6e7f8a9b0', date: '2026-02-20' },
                { wallet: '0x9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e2f1a0', date: '2026-02-20' },
                { wallet: '0x1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0', date: '2026-02-19' }
            ];
            
            sampleUsers.forEach(user => {
                const shortAddress = `${user.wallet.substring(0, 6)}...${user.wallet.substring(38)}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td title="${user.wallet}">${shortAddress}</td>
                    <td>${user.date}</td>
                `;
                newUsersBody.appendChild(row);
            });
            
            // ÊúÄËøëICO
            const recentICOBody = document.getElementById('recent-ico-body');
            recentICOBody.innerHTML = '';
            
            const sampleICO = [
                { wallet: '0x8f3a4c2d1e5b6a7c9d0f1e2a3b4c5d6e7f8a9b0', parts: 85, eth: 8.5 },
                { wallet: '0x9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e2f1a0', parts: 50, eth: 5.0 },
                { wallet: '0x1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0', parts: 25, eth: 2.5 }
            ];
            
            sampleICO.forEach(purchase => {
                const shortAddress = `${purchase.wallet.substring(0, 6)}...${purchase.wallet.substring(38)}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td title="${purchase.wallet}">${shortAddress}</td>
                    <td style="color: #ffff00;">${purchase.parts}</td>
                    <td style="color: #00ff00;">${purchase.eth} ETH</td>
                `;
                recentICOBody.appendChild(row);
            });
            
            // ÊúÄËøë‰∫§Êòì
            const recentTradesBody = document.getElementById('recent-trades-body');
            recentTradesBody.innerHTML = '';
            
            const sampleTrades = [
                { bot: 'AlphaBot_001', pair: 'ETH/USDT', roi: '+8.5%' },
                { bot: 'BetaBot_002', pair: 'BTC/USDT', roi: '+12.3%' },
                { bot: 'GammaBot_003', pair: 'SOL/USDT', roi: '+5.2%' }
            ];
            
            sampleTrades.forEach(trade => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${trade.bot}</td>
                    <td>${trade.pair}</td>
                    <td style="color: #00ff00;">${trade.roi}</td>
                `;
                recentTradesBody.appendChild(row);
            });
        }
        
        // Êõ¥Êñ∞Áî®Êà∑Ë°®Ê†º
        function updateUsersTable() {
            const usersBody = document.getElementById('users-body');
            usersBody.innerHTML = '';
            
            const sampleUsers = [
                { id: 1, wallet: '0x742d35Cc6634C0532925a3b844Bc9e90F1b6c168', username: 'Admin', level: 'king', parts: 1000, investment: 100 },
                { id: 2, wallet: '0x8f3a4c2d1e5b6a7c9d0f1e2a3b4c5d6e7f8a9b0', username: 'TestUser_123', level: 'gold', parts: 85, investment: 8.5 },
                { id: 3, wallet: '0x9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e2f1a0', username: 'CryptoTrader', level: 'silver', parts: 35, investment: 3.5 },
                { id: 4, wallet: '0x1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0', username: 'NewUser_456', level: 'bronze', parts: 5, investment: 0.5 }
            ];
            
            sampleUsers.forEach(user => {
                const shortAddress = `${user.wallet.substring(0, 6)}...${user.wallet.substring(38)}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td title="${user.wallet}">${shortAddress}</td>
                    <td>${user.username}</td>
                    <td><span style="color: ${getLevelColor(user.level)};">${user.level}</span></td>
                    <td style="color: #ffff00;">${user.parts}</td>
                    <td style="color: #00ff00;">${user.investment} ETH</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn" onclick="editUser(${user.id})">Edit</button>
                            <button class="btn danger" onclick="deleteUser(${user.id})">Delete</button>
                        </div>
                    </td>
                `;
                usersBody.appendChild(row);
            });
        }
        
        // Êõ¥Êñ∞ICO‰∫§ÊòìË°®Ê†º
        function updateICOTransactionsTable() {
            const icoBody = document.getElementById('ico-transactions-body');
            icoBody.innerHTML = '';
            
            const sampleTransactions = [
                { id: 1, wallet: '0x742d35Cc6634C0532925a3b844Bc9e90F1b6c168', parts: 500, eth: 50, date: '2026-02-20', status: 'confirmed' },
                { id: 2, wallet: '0x742d35Cc6634C0532925a3b844Bc9e90F1b6c168', parts: 500, eth: 50, date: '2026-02-20', status: 'confirmed' },
                { id: 3, wallet: '0x8f3a4c2d1e5b6a7c9d0f1e2a3b4c5d6e7f8a9b0', parts: 85, eth: 8.5, date: '2026-02-19', status: 'confirmed' },
                { id: 4, wallet: '0x9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e2f1a0', parts: 50, eth: 5.0, date: '2026-02-19', status: 'pending' }
            ];
            
            sampleTransactions.forEach(tx => {
                const shortAddress = `${tx.wallet.substring(0, 6)}...${tx.wallet.substring(38)}`;
                const statusColor = tx.status === 'confirmed' ? '#00ff00' : '#ffff00';
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${tx.id}</td>
                    <td title="${tx.wallet}">${shortAddress}</td>
                    <td style="color: #ffff00;">${tx.parts}</td>
                    <td style="color: #00ff00;">${tx.eth} ETH</td>
                    <td>${tx.date}</td>
                    <td><span style="color: ${statusColor};">${tx.status}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn" onclick="viewTransaction(${tx.id})">View</button>
                            ${tx.status === 'pending' ? '<button class="btn primary" onclick="confirmTransaction(' + tx.id + ')">Confirm</button>' : ''}
                        </div>
                    </td>
                `;
                icoBody.appendChild(row);
            });
        }
        
        // Ëé∑ÂèñÁ≠âÁ∫ßÈ¢úËâ≤
        function getLevelColor(level) {
            const colors = {
                'bronze': '#CD7F32',
                'silver': '#C0C0C0',
                'gold': '#FFD700',
                'platinum': '#E5E4E2',
                'king': '#FF0000'
            };
            return colors[level] || '#00ff00';
        }
        
        // ËøûÊé•Èí±ÂåÖ
        async function connectWallet() {
            try {
                if (typeof window.ethereum === 'undefined') {
                    alert('Please install MetaMask or another Ethereum wallet');
                    return;
                }
                
                // ËØ∑Ê±ÇË¥¶Êà∑ËÆøÈóÆ
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });
                
                if (accounts.length > 0) {
                    const wallet = accounts[0];
                    localStorage.setItem('smfun_wallet_account', wallet);
                    
                    // Ê£ÄÊü•ÊòØÂê¶ÊòØÁÆ°ÁêÜÂëò
                    if (ADMIN_WALLETS.includes(wallet.toLowerCase())) {
                        adminWallet = wallet;
                        await loadAdminDashboard();
                    } else {
                        showError('Access denied. This wallet is not authorized for admin access.');
                    }
                }
            } catch (error) {
                console.error('Error connecting wallet:', error);
                alert('Failed to connect wallet: ' + error.message);
            }
        }
        
        // ÊòæÁ§∫ÈîôËØØ
        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('connect-wallet').style.display = 'none';
            document.getElementById('error').style.display = 'block';
            document.getElementById('error-message').textContent = message;
        }
        
        // ÂäüËÉΩÂáΩÊï∞
        function exportUsers() {
            alert('Exporting users to CSV...');
            // ËøôÈáåÂ∫îËØ•ÊòØÂØºÂá∫Áî®Êà∑ÁöÑAPIË∞ÉÁî®
        }
        
        function refreshUsers() {
            location.reload();
        }
        
        function editUser(userId) {
            alert(`Edit user ${userId}`);
        }
        
        function deleteUser(userId) {
            if (confirm(`Are you sure you want to delete user ${userId}? This action cannot be undone.`)) {
                alert(`User ${userId} deleted (simulated)`);
            }
        }
        
        function addICOShares() {
            alert('Add ICO shares manually');
        }
        
        function exportICOData() {
            alert('Exporting ICO data to CSV...');
        }
        
        function resetICO() {
            if (confirm('‚ö†Ô∏è DANGER: This will reset all ICO data. Are you absolutely sure?')) {
                if (confirm('‚ö†Ô∏è This action cannot be undone. Type "RESET" to confirm:')) {
                    alert('ICO reset (simulated)');
                }
            }
        }
        
        function viewTransaction(txId) {
            alert(`View transaction ${txId}`);
        }
        
        function confirmTransaction(txId) {
            if (confirm(`Confirm transaction ${txId}?`)) {
                alert(`Transaction ${txId} confirmed (simulated)`);
                location.reload();
            }
        }
        
        function addAdminWallet() {
            const wallet = prompt('Enter new admin wallet address:');
            if (wallet && /^0x[a-fA-F0-9]{40}$/.test(wallet)) {
                alert(`Added admin wallet: ${wallet} (simulated)`);
            } else {
                alert('Invalid wallet address');
            }
        }
        
        function removeAdminWallet() {
            if (confirm('Remove current wallet from admin list?')) {
                alert('Admin wallet removed (simulated)');
                localStorage.removeItem('smfun_wallet_account');
                location.reload();
            }
        }
        
        function updateFees() {
            alert('Update fee settings');
        }
    </script>
</body>
</html>
